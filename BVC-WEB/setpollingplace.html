<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" type="text/css" href="main.css">

    <script src="./node_modules/web3/dist/web3.min.js"></script>
</head>
<body>
<script>
    if (typeof web3 !== 'undefined') {
        // 현재 사용가능한 Web3 열기, 예를 들면 크롬 metamask
        web3 = new Web3(web3.currentProvider);
    } else {
        //없다면 서버의 Web3 연결하기.
        //자신의 Web3가 로컬에 있다면 http://localhost:8545로 변경하면 됩니다.
        web3 = new Web3(new Web3.providers.HttpProvider("http://bug.lasel.kr:8545"));
    }
    //eth의 기본 지갑은 0번째 지갑입니다.
    web3.eth.defaultAccount = web3.eth.accounts[0];
    // contract로 abi를 정의해 줍니다. 해당 abi는 sol파일을 컴파일 했을 때 추출됩니다.
    var BVCContract = web3.eth.contract([{"constant":false,"inputs":[{"name":"_placeID","type":"uint256"}],"name":"getCandidate","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"getAllPlace","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"voterList","outputs":[{"name":"phone","type":"uint256"},{"name":"votedPlace","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_phone","type":"uint256"},{"name":"_votedPlace","type":"uint256"}],"name":"checkVoted","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_votedPlace","type":"uint256"},{"name":"_candidateID","type":"uint256"},{"name":"_phone","type":"uint256"}],"name":"vote","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"setPollingPlace","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"candidateList","outputs":[{"name":"placeID","type":"uint256"},{"name":"voteCount","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_placeID","type":"uint256"}],"name":"voteEnd","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"placeList","outputs":[{"name":"voting","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_placeID","type":"uint256"}],"name":"setCandidate","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_placeID","type":"uint256"}],"name":"voteStart","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"v","type":"uint256"}],"name":"uintToString","outputs":[{"name":"str","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_candidateID","type":"uint256"}],"name":"counting","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"}]);

    // eth의 컨트렉트 주소를 작성해줍니다. 블록체인에 많은 스마트 컨트렉트들 중에 자신의 컨트렉트를 찾기 위함입니다.
    // 여기까지 설정이 완료된다면 블록체인과 연결된 것입니다. 따라서 solidity파일에 작성한 함수와 변수를 사용할 수 있습니다.
    var BVC = BVCContract.at('0x203cfc9abf4f5cb421a6a11727117d916ad631b7');
    // 로그가 찍히면 연결성공
    console.log(BVC);

    // 현재 블록에 담겨있는 값을 가져와 json 형태로 변경한 후 출력합니다.
    // json 예제
    // var json = new Object();
    // json.result = "success";
    // json.placeID = result[0];
    // json.nn = result[1];
    // document.write(JSON.stringify(json));


    // BVC로 setPollingPlace 접근 필요...


</script>
</body>
</html>